YUI.add("terminal-dragedit",function(b,a){b.TerminalDragEdit=function(d){b.after(this._renderUIdragedit,this,"renderUI");b.after(this._bindUIdragedit,this,"bindUI");var c={"color":{value:"rgb(173,216,230)"},"weight":{value:4},"opacity":{value:1},"dashstyle":{value:"none"},"fill":{value:"rgb(255,255,255)"},"editwire-class":{value:b.BezierWire}};this.addAttrs(c,d);};b.TerminalDragEdit.ATTRS={editable:{value:true},graphic:{value:null},alwaysSrc:{value:false}};b.TerminalDragEdit.prototype={_renderUIdragedit:function(){if(this.get("editable")){this.get("contentBox").addClass(this.getClassName("editable"));var d=new b.DD.Drag({node:this.get("contentBox"),groups:this.get("groups")}).plug(b.Plugin.DDProxy,{cloneNode:true,moveOnEnd:false});this.drag=d;var c=new b.DD.Drop({node:this.get("contentBox"),groups:this.get("groups")});c.terminal=this;this.drop=c;}},_bindUIdragedit:function(){var c=this.drag;if(c){c.on("drag:start",this._onDragEditStart,this);c.on("drag:drag",this._onDragEditDrag,this);c.on("drag:drophit",this._onDragEditDrophit,this);c.on("drag:dropmiss",this._onDragEditDropmiss,this);c.on("drag:enter",this._onDragEditEnter,this);c.on("drag:exit",this._onDragEditExit,this);}},_onDragEditStart:function(e){this._editwireX=e.pageX;this._editwireY=e.pageY;var c=this.get("dir");var d=this;if(!this.get("graphic")){this.set("graphic",this.get("root").graphic);}this.drag.wire=this.get("graphic").addShape({type:this.get("editwire-class"),stroke:{weight:this.get("weight"),color:this.get("color"),opacity:this.get("opacity"),dashstyle:this.get("dashstyle"),fill:this.get("fill")},src:{getXY:function(){return[e.pageX,e.pageY];}},tgt:{getXY:function(){return[d._magnetX||d._editwireX,d._magnetY||d._editwireY];}},srcDir:c,tgtDir:[-c[0],-c[1]]});},_onDragEditDrag:function(c){this._editwireX=c.pageX;this._editwireY=c.pageY;this.drag.wire._draw();},_onDragEditDrophit:function(c){if(this.isValidWireTerminal(c.drop.terminal)){if(c.drop.terminal.alwaysSrc){this.drag.wire.set("src",c.drop.terminal);this.drag.wire.set("tgt",this);}else{this.drag.wire.set("src",this);this.drag.wire.set("tgt",c.drop.terminal);}this.drag.wire=null;this._magnetX=null;this._magnetY=null;}else{this.drag.wire.destroy();}},_onDragEditDropmiss:function(c){this.drag.wire.destroy();this.drag.wire=null;},_onDragEditEnter:function(c){var d=c.drop.terminal.getXY();this._magnetX=d[0];this._magnetY=d[1];this.drag.wire.set("tgtDir",c.drop.terminal.get("dir"));},_onDragEditExit:function(c){this._magnetX=null;this._magnetY=null;},isValidWireTerminal:function(c){if(this.get("parent")!==undefined&&(this.get("parent").get("preventSelfWiring"))){if(c._parentNode._node==this._parentNode._node){return false;}}return true;},destructor:function(){if(this.drag){this.drag.destroy();}if(this.drop){this.drop.destroy();}}};},"@VERSION@",{"requires":["bezier-wire","dd-drop","dd-drag","dd-proxy"]});